<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <table>
            <tr th:each="item : ${itemsToDelete}">
                <td th:text="${item.name}"></td>
                <td th:text="${item.price}"></td>
                <td th:text="${item.color}"></td> 
                <td th:text="${item.computerBrand}"></td>
                <td th:text="${item.releaseDate}"></td>
                <td th:text="${item.description}"></td>
                <td th:text="${item.weight}"></td>
                <td><button class="delete-button" th:data-id="${item.ID}">Delete</button></td>
            </tr>
            <div id="loadstuffhere"></div>
        </table>
        <script type="text/javascript">
            // Gets all the buttons in the DOM
            var listOfDeleteButtons = document.getElementsByClassName("delete-button");

            // For each button, attach a click handler
            for(let buttonIndex = 0; buttonIndex < listOfDeleteButtons.length; buttonIndex++) {
                listOfDeleteButtons[buttonIndex].onclick = function() {
                    // Creates an object to send request to web server
                    var xhr = new XMLHttpRequest();
                    xhr.buttonholder = this;
                    // Define the request method and url
                    xhr.open("DELETE", "http://localhost/computer/deleteform/" + this.dataset.id);

                    // Set header
                    xhr.setRequestHeader("Accept", "application/json");

                    // Set a function to run on state state change
                    xhr.onreadystatechange = function () {
                        // state == 4
                        if (xhr.readyState === 4) {
                            xhr.buttonholder.parentElement.parent.Element.remove();
                            // Log out the status and response to the console
                            console.log(xhr.status);
                            console.log(xhr.responseText);
                            // inject the response text into the html tag with id "loadstuffhere"
                            document.getElementById("loadstuffhere").innerText = xhr.responseText;
                        }
                    };

                    // Send the request
                    xhr.send();
                }
            }
        </script>
    </body> 

</html>